<!DOCTYPE html>
<html>
<head>
  <title>Quizløype - Lokasjon</title>
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <style>
    body { font-family: Arial; padding: 1em; max-width: 500px; margin: auto; }
    label, select, button { display: block; margin-top: 1em; }
    #question { margin-top: 2em; font-weight: bold; }
  </style>
</head>
<body>
  <h2>Quizløype - Lokasjon</h2>
  <label for="team">Velg lag:</label>
  <select id="team">
    <option value="">-- Velg lag --</option>
    <option value="Lag 1">Lag 1</option>
    <option value="Lag 2">Lag 2</option>
    <option value="Lag 3">Lag 3</option>
    <option value="Lag 4">Lag 4</option>
    <option value="Lag 5">Lag 5</option>
    <option value="Lag 6">Lag 6</option>
    <option value="Lag 7">Lag 7</option>
    <option value="Lag 8">Lag 8</option>
    <option value="Lag 9">Lag 9</option>
    <option value="Lag 10">Lag 10</option>
    <option value="Lag 11">Lag 11</option>
    <option value="Lag 12">Lag 12</option>
  </select>

  <label for="post">Velg post:</label>
  <select id="post">
    <option value="">-- Velg post --</option>
    <option value="Post 1">Post 1</option>
    <option value="Post 2">Post 2</option>
    <option value="Post 3">Post 3</option>
    <option value="Post 4">Post 4</option>
  </select>

  <button onclick="checkPosition()">Sjekk posisjon</button>

  <div id="message"></div>
  <div id="question"></div>
  

<script>
  // Struktur: postCoordinates[lag][post] = {lat, lon} - Trenger gjeldene siffer
  const postCoordinates = {
    "Lag 1": {
      "Post 1": { lat: 59.911, lon: 10.640 },
      "Post 2": { lat: 59.912, lon: 10.751 },
      "Post 3": { lat: 59.913, lon: 10.752 },
      "Post 4": { lat: 59.914, lon: 10.753 }
    },
    "Lag 2": {
      "Post 1": { lat: 59.921, lon: 10.75 },
      "Post 2": { lat: 59.922, lon: 10.751 },
      "Post 3": { lat: 59.923, lon: 10.752 },
      "Post 4": { lat: 59.924, lon: 10.753 }
    },
    // Legg til Lag 3–12 her på samme måte
  };

  const quizQuestions = {
    "Post 1": "Hvilket år ble firmaet stiftet?",
    "Post 2": "Hva er hovedproduktet vårt?",
    "Post 3": "Hva står forkortelsen i firmanavnet for?",
    "Post 4": "Hvor mange ansatte hadde vi i 2020?"
  };

  const maxDistanceMeters = 50;

  function checkPosition() {
    const team = document.getElementById("team").value;
    const post = document.getElementById("post").value;
    const msg = document.getElementById("message");
    const questionBox = document.getElementById("question");

    msg.innerText = "";
    questionBox.innerText = "";

    if (!team || !post) {
      msg.innerText = "Velg både lag og post.";
      return;
    }

    if (!postCoordinates[team] || !postCoordinates[team][post]) {
      msg.innerText = "Ingen lokasjon definert for dette laget og denne posten.";
      return;
    }

    if (!navigator.geolocation) {
      msg.innerText = "Geolokasjon støttes ikke av nettleseren.";
      return;
    }

    navigator.geolocation.getCurrentPosition(
      function(position) {
        const userLat = position.coords.latitude;
        const userLon = position.coords.longitude;
        const target = postCoordinates[team][post];

        const dist = distanceInMeters(userLat, userLon, target.lat, target.lon);

        if (dist <= maxDistanceMeters) {
          questionBox.innerText = quizQuestions[post] || "Ingen spørsmål definert.";
        } else {
          msg.innerText = `Du er ${Math.round(dist)} meter unna riktig posisjon. Gå nærmere posten.`;
        }
      },
      function(error) {
        msg.innerText = "Klarte ikke hente posisjon: " + error.message;
      }
    );
  }

  function distanceInMeters(lat1, lon1, lat2, lon2) {
    const R = 6371000;
    const φ1 = lat1 * Math.PI / 180;
    const φ2 = lat2 * Math.PI / 180;
    const Δφ = (lat2 - lat1) * Math.PI / 180;
    const Δλ = (lon2 - lon1) * Math.PI / 180;

    const a = Math.sin(Δφ / 2) ** 2 +
              Math.cos(φ1) * Math.cos(φ2) *
              Math.sin(Δλ / 2) ** 2;
    const c = 2 * Math.atan2(Math.sqrt(a), Math.sqrt(1 - a));

    return R * c;
  }
</script>

  
  
</body>
</html>
